var define,require,use;!function(){var a={},b={},c=function(){},d=function(){},e={define:function(b,c,d){if(!a[b]){var e={name:b,dependencies:c,factory:d};a[b]=e}return a[b]},use:function(b){var e,f,d=a[b];if(!d.entity){for(e=[],f=0;f<d.dependencies.length;f++)a[d.dependencies[f]].entity?e.push(a[d.dependencies[f]].entity):e.push(this.use(d.dependencies[f]));d.entity=d.factory.apply(c,e)}return d.entity},require:function(a,c){function h(){var e,d=!0;for(e=0;e<a.length;e++)if(!b[a[e]]){d=!1;break}d&&c()}var d,e,f,g;for(d=0;d<a.length;d++)e=a[d],b[e]||(f=document.getElementsByTagName("head")[0],g=document.createElement("script"),g.type="text/javascript",g.async="true",g.src=e+".js",g.onload=function(){b[e]=!0,f.removeChild(g),h()},f.appendChild(g))},error:function(){},log:function(a){try{console.log(a)}catch(b){}}},f={on:function(a,b){this.eventMap||(this.eventMap={}),this.eventMap[a]||(this.eventMap[a]=[]),this.eventMap[a].push(b)},off:function(a,b){for(var c=0;c<this.eventMap[a].length;c++)if(this.eventMap[a][c]===b){this.eventMap[a].splice(c,1);break}},fire:function(a){var c,b=a.type;if(this.eventMap&&this.eventMap[b])for(c=0;c<this.eventMap[b].length;c++)this.eventMap[b][c](a)}};Object.extend=function(a,b){for(var c in b)a[c]=b[c];return a},Object.extend(d,f),Object.extend(d,e),d.define("Events",[],function(){return f}),window.king=d,define=d.define,require=d.require,use=d.use,d.on("ready",function(){d.require(["../src/modules/core/binding"],function(){var a=d.use("DataBinding");a.parse(document.body)})})}(),king.define("DataBinding",[],function(){function c(a,b){var g,h,f=b;for(a.getAttribute("king-bind-model")&&(f=e(a.getAttribute("king-bind-model"))),g=0;g<a.attributes.length;g++)d(a,a.attributes[g],f);for(g=0;g<a.children.length;g++)c(a.children[g],f);if(b!==f){for(h in f.$watchers)f[h]=f.$watchers[h].value;f.$initializer&&f.$initializer()}}function d(a,b,c){if(0===b.name.indexOf("king-bind-")){var d=b.name.slice(10);switch(d){case"init":h(a,b.value,c);break;case"value":f(a,b.value,c);break;case"list":g(a,b.value,c);break;case"click":i(a,b.value,c);break;case"enable":j(a,b.value,c,!0);break;case"disable":j(a,b.value,c,!1);break;case"visible":k(a,b.value,c,!0);break;case"invisible":k(a,b.value,c,!1);break;case"element":c[b.value]=a}}}function e(b){var c,d;return king.log("binding model: "+b),c=king.use(b),d=new c,Object.extend(d,a),d.$watchers={},d}function f(a,b,c){function d(a,b,c){a.onkeyup=function(){c[b]=a.value,king.fire({type:"modelchange"})},a.onpaste=function(){c[b]=a.value,king.fire({type:"modelchange"})}}function e(a,b,c){a.onchange=function(){c[b]=a.value,king.fire({type:"modelchange"})}}switch(king.log("binding value: "+b),c.$watch(b,function(b){a.value=b||""}),a.tagName){case"SELECT":e(a,b,c);break;default:d(a,b,c)}}function g(a,b,c){king.log("binding list: "+b),c.$watch(b,function(b){var e,f,d=a.value;for(a.innerHTML=null,e=0;e<b.length;e++)f=document.createElement("option"),f.innerHTML=b[e].label,f.value=b[e].key,a.appendChild(f);a.value=d})}function h(a,b,c){king.log("binding init: "+b),c.$initializer=function(a){return function(){a[b](),king.fire({type:"modelchange"})}}(c)}function i(a,b,c){king.log("binding click: "+b),a.onclick=function(){c[b](),king.fire({type:"modelchange"})}}function j(a,c,d,e){king.log("binding enable: "+c),"function"==typeof d[c]?b.push(function(){a.style.disable=d[c]()^e?!0:!1}):d.$watch(c,function(b){a.disable=b^e?!0:!1})}function k(a,c,d,e){king.log("binding visible: "+c),"function"==typeof d[c]?b.push(function(){a.style.display=d[c]()^e?"none":""}):d.$watch(c,function(b){a.style.display=b^e?"none":""})}function l(){var a;for(a=0;a<b.length;a++)b[a]()}var a={$watch:function(a,b){this.$watchers[a]||(this.$watchers[a]={value:this[a],list:[]},Object.defineProperty(this,a,{set:function(b){var c,d=this.$watchers[a].value;for(this.$watchers[a].value=b,c=0;c<this.$watchers[a].list.length;c++)this.$watchers[a].list[c](b,d)},get:function(){return this.$watchers[a].value}})),this.$watchers[a].list.push(b)}},b=[];return king.on("modelchange",function(){l()}),{parse:c}});